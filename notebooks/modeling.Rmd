---
title: "Frito Lay: Customer Attrition - Multivariate Analysis"
output: 
  github_document:
    html_preview: false
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  echo = TRUE,       
  warning = FALSE,   
  message = FALSE    
)
```

```{r}
library(tidyverse)
library(caret)
library(e1071)
library(class)
library(scales)
library(ggthemes)
theme_set(theme_economist())
title_format <- function(x) labs(title = x, x = NULL, y = NULL)
```

## ------------ Data Loading -------------
```{r}
# getwd()
data <- read.csv("../data/CaseStudy1-data.csv")
```

## ------------ Data Preparation -------------

```{r}
str(data)
```

### ------------- Remove Low Variance and Constant Features -------------

```{r}
# Check if each column contains only unique values
unique_check <- sapply(data, function(x) length(unique(x)) == nrow(data))

# Check if each column contains only one unique value
constant_check <- sapply(data, function(x) length(unique(x)) == 1)

col_check <- list(
  constant = names(data)[constant_check],
  unique = names(data)[unique_check]
)

col_check
dim(data)

data_v2 <- data %>%
  select(-one_of(col_check$constant)) %>%
  select(-one_of(col_check$unique))

dim(data_v2)
```

### ------------- Convert Categorical Variables to Factors -------------

```{r}
data_v3 <- data_v2 %>%
  mutate_if(is.character, as.factor)
str(data_v3)
```

